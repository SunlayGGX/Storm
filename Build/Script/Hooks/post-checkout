#!/bin/bash

echo
echo Running custom git hook

# Go back to the root
STORM_ROOT=$PWD
echo Storm root is $STORM_ROOT

# Get the current branch
echo Get the current git branch
STORM_CURRENT_GIT_BRANCH=$(git branch --show-current)

# Generate the git branch file config
STORM_AUTOGENERATED_GIT_BRANCH_FOLDER=$STORM_ROOT/Source/Generated
STORM_AUTOGENERATED_GIT_BRANCH_HEADER=$STORM_AUTOGENERATED_GIT_BRANCH_FOLDER/GitBranch.generated.h

echo Generating \"$STORM_AUTOGENERATED_GIT_BRANCH_HEADER\" with branch \"$STORM_CURRENT_GIT_BRANCH\"

mkdir -p $STORM_AUTOGENERATED_GIT_BRANCH_FOLDER

echo "// This file is autogenerated from git hooks.
#pragma once

#define STORM_CURRENT_GIT_BRANCH \"$STORM_CURRENT_GIT_BRANCH\"
" > $STORM_AUTOGENERATED_GIT_BRANCH_HEADER
